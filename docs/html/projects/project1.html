

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project 1: Weighted Delta Tracking &mdash; NRE7203 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Project 2: Placeholder" href="project2.html" />
    <link rel="prev" title="Projects" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NRE7203
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Class Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Projects</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Project 1: Weighted Delta Tracking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#methodology">Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results">Results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#case-1">Case 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#case-2">Case 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#case-3">Case 3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#conclusions">Conclusions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="project2.html">Project 2: Placeholder</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NRE7203</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Projects</a></li>
      <li class="breadcrumb-item active">Project 1: Weighted Delta Tracking</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/projects/project1.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="project-1-weighted-delta-tracking">
<span id="proj1"></span><h1>Project 1: Weighted Delta Tracking<a class="headerlink" href="#project-1-weighted-delta-tracking" title="Link to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>Weighted delta tracking is implemented for Monte Carlo simulations of neutron transport as a nonanalog method. The technique uses formalisms developed in Woodcock delta tracking but removes probability sampling for real or virtual collisions. This technique also uses implicit capture to adjust neutron weight during its random walk. Using weighted delta tracking with Russian Roulette, the algorithm performance is compared against surface tracking and standard delta tracking with an analytical solution for reference.</p>
<p>The weighted delta tracking algorithm and associated data processing is completed using <code class="docutils literal notranslate"><span class="pre">pointsource_sphere.py</span></code> which contains the class <code class="docutils literal notranslate"><span class="pre">PointSourceInSphere</span></code>. The functions contained within <code class="docutils literal notranslate"><span class="pre">PointSourceInSphere</span></code> include an analytic solver, a solver for surface tracking (ST), a solver for delta tracking (DT), a solver for weighted delta tracking (WDT), and associated post processing functions such as statistical analysis and plotting.</p>
<p>The Monte Carlo simulation is initialized within the class using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nMC</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">sigT</span><span class="p">):</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">nMC</span></code> represents the number of Monte Carlo simulations, <code class="docutils literal notranslate"><span class="pre">S0</span></code> is the source strength, <code class="docutils literal notranslate"><span class="pre">R</span></code> is the radius of the outermost sphere in a series of concentric spherical shells, and <code class="docutils literal notranslate"><span class="pre">sigT</span></code> is an array containing total cross sections for each region.</p>
<p>All solutions are developed in a Jupyter Notebook, a sample of which can be found here.</p>
<p><a class="reference internal" href="Monte%20Carlo%20Jupyter%20Notebook.html#montecarlojupyternotebook"><span class="std std-ref">Weighted Delta Tracking Notebook</span></a></p>
</section>
<section id="methodology">
<h2>Methodology<a class="headerlink" href="#methodology" title="Link to this heading"></a></h2>
<p>The general approach to implementing a WDT solver with Russian Roulette is:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Sample neutron position following streaming.</p></li>
<li><p>Calculate neutron weight to be tallied for regions crossed from previous location to current.</p></li>
<li><p>Reduce neutron weight following the “collision.” (Representing a portion of the neutron absorbed, the remainder to continue its random walk.)</p></li>
<li><p>Check neutron weight against a threshold weight, if above the threshold repeat steps 1:4. If below the threshold, complete step 5.</p></li>
<li><p>Play Russian Roulette for survival and restore weight upon survival or terminate the neutron.</p></li>
</ol>
</div></blockquote>
<dl>
<dt>This project uses the majorant cross section, defined as <span class="math notranslate nohighlight">\(\Sigma_{maj} = max(\Sigma_{t,i})\)</span>, where <em>i</em> is over all regions. From this definition a pathlength is determined using</dt><dd><div class="math notranslate nohighlight">
\[S = \frac{-ln(\xi)}{\Sigma_{maj}}\]</div>
</dd>
</dl>
<p><span class="math notranslate nohighlight">\(\xi\)</span> is a random number drawn from a uniform distribution between 0 and 1. Assuming a point source, all neutrons are born at the origin (0,0,0).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Neutron directional quantities are sampled using the following:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\theta = \arccos(1 - 2\xi_{1})\\\phi = 2\pi\xi_{2}\end{aligned}\end{align} \]</div>
</div>
<p>The weight tallied for all regions crossed is given by <span class="math notranslate nohighlight">\(w_{i-1}(\frac{\Sigma_{t,i}}{\Sigma_{maj}})\)</span> and the reduction in neutron weight is calculated using <span class="math notranslate nohighlight">\(w_{i}=w_{i-1}(1-\frac{\Sigma_{t,i}}{\Sigma_{maj}})\)</span>. This value is then tested against the weight threshold:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">weight</span> <span class="o">&lt;</span> <span class="n">weight_threshold</span><span class="p">:</span>
        <span class="n">survival_prob</span> <span class="o">=</span> <span class="n">weight</span><span class="o">/</span><span class="n">weight_0</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">survival_prob</span><span class="p">:</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="n">weight_0</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">break</span></code> is encountered, the neutron is terminated. Otherwise, the neutron continues its random walk with its weight restored. At this point the position and region index are updated.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span>
<span class="n">idx_prev</span> <span class="o">=</span> <span class="n">idx_curr</span>
</pre></div>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Link to this heading"></a></h2>
<section id="case-1">
<h3>Case 1<a class="headerlink" href="#case-1" title="Link to this heading"></a></h3>
<p>Three cases were tested. The first test considered ten regions with macroscopic cross sections bounded between 0.1 and 0.25 cm <span class="math notranslate nohighlight">\(^{-1}\)</span> and randomly generated using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>Using the ST, DT, and WDT routines, the following flux results were obtained. The cross sections are given by the histogram below. The flux tally in each of the ten regions is overlaid on the analytic flux for the given cross sections. The case that generated these plots was 100 simulations at 10000 neutrons with a outer radius of 12 cm <span class="math notranslate nohighlight">\(^{-1}\)</span>.</p>
<a class="reference internal image-reference" href="../_images/case1histograms.png"><img alt="../_images/case1histograms.png" class="align-center" src="../_images/case1histograms.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case1STflux.png"><img alt="../_images/case1STflux.png" class="align-center" src="../_images/case1STflux.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case1DTflux.png"><img alt="../_images/case1DTflux.png" class="align-center" src="../_images/case1DTflux.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case1WDTflux.png"><img alt="../_images/case1WDTflux.png" class="align-center" src="../_images/case1WDTflux.png" style="width: 600px;" />
</a>
</section>
<section id="case-2">
<h3>Case 2<a class="headerlink" href="#case-2" title="Link to this heading"></a></h3>
<p>The second case defined <span class="math notranslate nohighlight">\(\Sigma_{t}\)</span> in the seventh region as 3 cm <span class="math notranslate nohighlight">\(^{-1}\)</span>. All other cross sections were randomly generated as in case 1. The same simulation parameters were chosen. The resulting flux plots were generated based on the cross sections:</p>
<a class="reference internal image-reference" href="../_images/case2histogram.png"><img alt="../_images/case2histogram.png" class="align-center" src="../_images/case2histogram.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case2STflux.png"><img alt="../_images/case2STflux.png" class="align-center" src="../_images/case2STflux.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case2DTflux.png"><img alt="../_images/case2DTflux.png" class="align-center" src="../_images/case2DTflux.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case2WDTflux.png"><img alt="../_images/case2WDTflux.png" class="align-center" src="../_images/case2WDTflux.png" style="width: 600px;" />
</a>
</section>
<section id="case-3">
<h3>Case 3<a class="headerlink" href="#case-3" title="Link to this heading"></a></h3>
<p>The third case returned cross sections to being uniformly distributed between 0.1 and 0.25 cm <span class="math notranslate nohighlight">\(^{-1}\)</span>. However, this case used 30 regions. Again the same simulation parameters were used. The resulting flux plots were obtained with the cross sections shown below.</p>
<a class="reference internal image-reference" href="../_images/case3histogram.png"><img alt="../_images/case3histogram.png" class="align-center" src="../_images/case3histogram.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case3STflux.png"><img alt="../_images/case3STflux.png" class="align-center" src="../_images/case3STflux.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case3DTflux.png"><img alt="../_images/case3DTflux.png" class="align-center" src="../_images/case3DTflux.png" style="width: 600px;" />
</a>
<a class="reference internal image-reference" href="../_images/case3WDTflux.png"><img alt="../_images/case3WDTflux.png" class="align-center" src="../_images/case3WDTflux.png" style="width: 600px;" />
</a>
<p>The tables below give relevant data in terms of leakage, runtimes, flux standard deviations, and figures of merit (FoM) for each case and each routine tested. The FoM is calculated as:</p>
<div class="math notranslate nohighlight">
\[FoM = \frac{1}{T_{run}\sigma_{flux}^{2}}\]</div>
<p><em>Case 1 Summary Results</em></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\Delta\)</span> Leakage [%]</p></th>
<th class="head"><p>Runtime [s]</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\sigma_{flux}\)</span></p></th>
<th class="head"><p>FoM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ST</p></td>
<td><p>0.01</p></td>
<td><p>22.85</p></td>
<td><p>45.48</p></td>
<td><p>2.12E-5</p></td>
</tr>
<tr class="row-odd"><td><p>DT</p></td>
<td><p>0.04</p></td>
<td><p>20.54</p></td>
<td><p>45.42</p></td>
<td><p>2.36E-5</p></td>
</tr>
<tr class="row-even"><td><p>WDT</p></td>
<td><p>0.02</p></td>
<td><p>25.58</p></td>
<td><p>44.49</p></td>
<td><p>1.98E-5</p></td>
</tr>
</tbody>
</table>
<p><em>Case 2 Summary Results</em></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\Delta\)</span> Leakage [%]</p></th>
<th class="head"><p>Runtime [s]</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\sigma_{flux}\)</span></p></th>
<th class="head"><p>FoM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ST</p></td>
<td><p>0.00</p></td>
<td><p>21.33</p></td>
<td><p>46.12</p></td>
<td><p>2.20E-5</p></td>
</tr>
<tr class="row-odd"><td><p>DT</p></td>
<td><p>0.00</p></td>
<td><p>89.64</p></td>
<td><p>46.62</p></td>
<td><p>5.13E-6</p></td>
</tr>
<tr class="row-even"><td><p>WDT</p></td>
<td><p>0.00</p></td>
<td><p>203.66</p></td>
<td><p>9.62</p></td>
<td><p>5.31E-5</p></td>
</tr>
</tbody>
</table>
<p><em>Case 3 Summary Results</em></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\Delta\)</span> Leakage [%]</p></th>
<th class="head"><p>Runtime [s]</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\sigma_{flux}\)</span></p></th>
<th class="head"><p>FoM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ST</p></td>
<td><p>0.03</p></td>
<td><p>39.01</p></td>
<td><p>50.44</p></td>
<td><p>1.01E-5</p></td>
</tr>
<tr class="row-odd"><td><p>DT</p></td>
<td><p>0.01</p></td>
<td><p>22.20</p></td>
<td><p>53.69</p></td>
<td><p>1.56E-5</p></td>
</tr>
<tr class="row-even"><td><p>WDT</p></td>
<td><p>0.04</p></td>
<td><p>27.75</p></td>
<td><p>40.49</p></td>
<td><p>2.18E-5</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading"></a></h2>
<p>In summary, surface tracking, standard delta tracking, and weighted delta tracking were analyzed against analytic solutions to neutron transport through concentric spherical shells with heterogenous macroscopic cross sections.
By varying the number of shells and the macroscopic cross sections, the differences between solution methods were identified.
Delta tracking and weighted delta tracking were penalized in case 2 due to the insertion of a large macroscopic cross section.
Surface tracking was penalized when the number of regions, therefore surfaces, was increased. From these results, the times in which one uses different algorithms is dependent on the physical system modeled.
The difference in analytic and weighted delta tracking flux in case 2 warrants additonal study. It is expected the roulette played is inadequate in overcoming the large majorant cross section which reduces neutron weight rapidly.
Overall, it is interesting to see the performance differences in the presented algorithms.</p>
<p>Return to the top of the page: <a class="reference internal" href="#proj1"><span class="std std-ref">Project 1: Weighted Delta Tracking</span></a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Projects" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="project2.html" class="btn btn-neutral float-right" title="Project 2: Placeholder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Blankenship J.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>